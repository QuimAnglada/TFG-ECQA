# TFG-ECQA
En aquest treball, s'ha dissenyat una estació de control de qualitat d'aigua basada en l'Internet de les coses de baix cost econòmic i tècnicament fàcil d'incorporar. L'objectiu de l'estació és millorar la gestió de processos on l'aigua té un paper principal. La placa de desenvolupament utilitzada és l'ESP32-EVB-EA-IND de la companyia Olimex. Els paràmetres mesurats són la temperatura, la pressió, els sòlids dissolts, la terbolesa i el pH amb els sensors DS18B20 (AZ-Delivery), SEN0244, SEN0189, SEN0257 i SEN0169-V2 (DFRobot). Les dades mesurades són enviades i mostrades en un monitor de control emprant el protocol Message Queuing Telemetry Transport (MQTT) a través dels softwares d'Eclipse Mosquitto i Node-Red.

# Biblioteques
Els autors de les biblioteques utilitzades han estat extrets de la pàgina web de les llibreries d'Arduino [60]. Si no hi són, han estat extrets dels repositoris de Github o bé de l'empre-sa Espressif, creadora de l'ESP8266 i ESP32 entre d'altres [61].
Per controlar la pantalla tàctil es fa servir les llibreri-es Adafruit_STMPE610.h i Adafruit_GFX_Library.h, la primera d'elles controla el tàctil i la segona permet mostrar el contingut d'interès en diferents colors. Ambdues llibreries han estat desenvolupades per la companyia Adafruit.
FS.h i LITTLEFS.h són dues biblioteques que permeten llegir, escriure, tancar, carregar i suprimir fitxers de la memòria flash. La llibreria FS.h va ser creada per Ivan Grokhotkov, mentre queLITTLEFS.h és una modificació del codi original feta per l'usua-ri Lorol de Github. Ambdues biblioteques van ser produïdes per Espressif. Els fitxers em-magatzemats en la memòria flash poden ser documents de text (.txt), documents de valors separats per comes (.csv) o imatges (.png) entre d'altres. Les llibreri-es PNGdec.h i PNG_func.h permeten descodificar imatges en format .png per tal de mos-trar-les per pantalla, biblioteques dutes a terme per BitBank Software i el Dr. Rubén Mercadé Prieto de l'Institut Químic de Sarrià respectivament. A la memò-ria flash també es poden emmagatzemar dades com l'última data en la qual es va calibrar un sensor, per guardar aquesta informació s'utilitza la llibreria Preferences.h, el seu autor és Volodymyr Shymanskyy. La informació ubicada en la memòria flash no és perduda en cas problemes d'alimentació o després de reiniciar l'equip.
Gràcies a les biblioteques SD_MMC.h i SDMMC_func.h les dades mesurades es poden emmagatzemar a la targeta micro SD, les llibreries han estat desenvolupades per Espressif i el Dr. Rubén Mercadé Prieto.

Per poder connectar l'equip a una xarxa Wi-Fi, comprovar el seu estat, reconnectar-se en cas de pèrdua de connexió o observar si hi ha altres xarxes al voltant es fa servir la biblio-teca WiFi.h d'Espressif, s'usa la modificació de desembre 2014 realitzada per Ivan Grokhotkov.
Una vegada l'equip està connectat a internet s'obté el temps mitjan-çant time.h i ESP32Time.h, els autors són Michael Margolis i Felix Biego.
El convertidor de senyal analògic a digital requereix Wire.h i SoftwareWire.h per la seva comunicació amb l'ESP32. Ambdues llibreries permeten fer servir el protocol de comunica-ció I2C i es fa ús de la mateixa llibreria pel mestre i l'esclau. Els autors són Nicholas Zambetti d'Espressif i Koepel Testato respectivament. Pel seu propi funcio-nament s'empra la llibreria ADS1115.h desenvolupada per Seed Studio.
Pel funcionament del sensor de temperatura es fan servir les llibreri-es OneWire.h i DallasTemperature.h . La primera d'elles és la versió actualitzada per Paul Stoffregen i la segona és la versió creada per Miles Burton. La resta de sensors no necessiten cap llibreria perquè són sensors analògics. Si és d'interès fer servir el proto-col MQTT per enviar les dades de l'ECQA al monitor de control, és necessària la bibliote-ca PubSubClient.h de l'autor Nick O'Leary.
